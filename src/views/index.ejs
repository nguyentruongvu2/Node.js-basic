<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="/css/style.css" />
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/5/w3.css" />
  </head>

  <body>
    <div class="topnav">
      <a class="active" href="#home">Home</a>
      <a href="#news">News</a>
      <a href="#contact">Contact</a>
      <a href="#about">About</a>
    </div>
    <div class="w3-container">
      <h2>List Users</h2>
      <table class="w3-table-all w3-hoverable">
        <thead>
          <tr class="w3-light-grey">
            <th>Id</th>
            <th>Last Name</th>
            <th>First Name</th>
            <th>Address</th>
            <th>Email</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <% for(let i=0;i< dataUser.length;i++) { %>
          <tr>
            <td><%=dataUser[i].id%></td>
            <td><%=dataUser[i].lastName%></td>
            <td><%=dataUser[i].firstName%></td>
            <td><%=dataUser[i].address%></td>
            <td><%=dataUser[i].email%></td>
            <td class="actions">
              <a href="/detail/user/<%= dataUser[i].id %>">
                <button>Detail</button>
              </a>
              <form action="/edit-user/<%= dataUser[i].id %>" method="GET">
                <button type="submit">Edit</button>
              </form>

              <form action="/delete-user" method="POST">
                <input
                  type="text"
                  hidden
                  value="<%= dataUser[i].id %>"
                  name="userId"
                />
                <button type="submit">Delete</button>
              </form>
            </td>
          </tr>
          <%}%>
        </tbody>
      </table>
    </div>
    <div class="create-user-container">
      <form action="/create-new-user" method="post" id="userForm">
        <div><b>Create a new user</b></div>
        <!-- <div>
          <label>Id</label>
          <input type="text" name="id" />
        </div> -->
        <div>
          <label>LastName</label>
          <input type="text" name="lastName" />
        </div>
        <div>
          <label>FristName</label>
          <input type="text" name="firstName" />
        </div>
        <div>
          <label>Email</label>
          <input type="email" name="email" />
        </div>
        <div>
          <label>Address</label>
          <input type="text" name="address" />
        </div>
        <div class="btn-submit">
          <button type="submit">Submit</button>
        </div>
      </form>
    </div>

    <script>
      document.getElementById("userForm").onsubmit = function (e) {
        let lastName = document
          .querySelector("input[name='lastName']")
          .value.trim();
        let firstName = document
          .querySelector("input[name='firstName']")
          .value.trim();
        let email = document.querySelector("input[name='email']").value.trim();
        let address = document
          .querySelector("input[name='address']")
          .value.trim();

        if (
          lastName === "" ||
          firstName === "" ||
          email === "" ||
          address === ""
        ) {
          alert("Vui lòng nhập đầy đủ thông tin!");
          e.preventDefault(); // chặn submit
          return false;
        }

        let regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!regex.test(email)) {
          alert("Email không hợp lệ!");
          e.preventDefault();
          return false;
        }

        return true;
      };
    </script>
  </body>
</html>
